# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/111g4Y9gPHIAAj9kLa364qHwgfcbP3hWX
"""

import streamlit as st
import numpy as np
import pickle

# Táº£i mÃ´ hÃ¬nh vÃ  scaler
model = pickle.load(open("logistic_asd_model.pkl", "rb"))
scaler = pickle.load(open("scaler.pkl", "rb"))

st.set_page_config(page_title="SÃ ng Lá»c Tá»± Ká»·", page_icon="ğŸ§ ", layout="centered")
st.title("ğŸ” á»¨ng dá»¥ng SÃ ng Lá»c Tá»± Ká»· (ASD)")

# Giao diá»‡n nháº­p thÃ´ng tin
def nhap_du_lieu():
    st.header("ğŸ“ Vui lÃ²ng tráº£ lá»i cÃ¡c cÃ¢u há»i sau:")

    # 10 cÃ¢u há»i A1 Ä‘áº¿n A10
    a1 = st.selectbox("1. CÃ³ khi nÃ o ngÆ°á»i Ä‘Ã³ giÃ¡ trÃ¡nh giao tiáº¿p báº±ng máº¯t?", ["KhÃ´ng", "CÃ³"])
    a2 = st.selectbox("2. NgÆ°á»i Ä‘Ã³ cÃ³ thÃ­ch chÆ¡i má»™t mÃ¬nh?", ["KhÃ´ng", "CÃ³"])
    a3 = st.selectbox("3. NgÆ°á»i Ä‘Ã³ cÃ³ hay láº·p láº¡i tá»«/ngÃ´n ngá»¯ khÃ´ng?", ["KhÃ´ng", "CÃ³"])
    a4 = st.selectbox("4. NgÆ°á»i Ä‘Ã³ cÃ³ khÃ³ khÄƒn khi hiá»ƒu cáº£m xÃºc ngÆ°á»i khÃ¡c?", ["KhÃ´ng", "CÃ³"])
    a5 = st.selectbox("5. CÃ³ khi nÃ o ngÆ°á»i Ä‘Ã³ khÃ´ng pháº£n há»“i khi Ä‘Æ°á»£c gá»i tÃªn?", ["KhÃ´ng", "CÃ³"])
    a6 = st.selectbox("6. NgÆ°á»i Ä‘Ã³ cÃ³ nháº¡y cáº£m vá»›i Ã¢m thanh khÃ´ng?", ["KhÃ´ng", "CÃ³"])
    a7 = st.selectbox("7. CÃ³ khi nÃ o ngÆ°á»i Ä‘Ã³ khÃ´ng chia sáº» há»©ng thÃº hoáº·c thÃ nh tÃ­ch vá»›i ngÆ°á»i khÃ¡c?", ["KhÃ´ng", "CÃ³"])
    a8 = st.selectbox("8. NgÆ°á»i Ä‘Ã³ cÃ³ hÃ nh vi láº·p Ä‘i láº·p láº¡i khÃ´ng?", ["KhÃ´ng", "CÃ³"])
    a9 = st.selectbox("9. NgÆ°á»i Ä‘Ã³ cÃ³ gáº·p khÃ³ khÄƒn khi thay Ä‘á»•i thÃ³i quen hoáº·c mÃ´i trÆ°á»ng khÃ´ng?", ["KhÃ´ng", "CÃ³"])
    a10 = st.selectbox("10. CÃ³ khi nÃ o ngÆ°á»i Ä‘Ã³ khÃ´ng hiá»ƒu cÃ¡c quy táº¯c xÃ£ há»™i cÆ¡ báº£n khÃ´ng?", ["KhÃ´ng", "CÃ³"])

    # Chuyá»ƒn Ä‘á»•i thÃ nh sá»‘
    scores = [a1, a2, a3, a4, a5, a6, a7, a8, a9, a10]
    scores = [1 if s == "CÃ³" else 0 for s in scores]

    # CÃ¡c Ä‘áº·c trÆ°ng khÃ¡c
    used_app_before = st.selectbox("11. Báº¡n Ä‘Ã£ tá»«ng sá»­ dá»¥ng á»©ng dá»¥ng nÃ y chÆ°a?", ["ChÆ°a", "Rá»“i"])
    jundice = st.selectbox("12. Tráº» cÃ³ bá»‹ vÃ ng da sau sinh khÃ´ng?", ["KhÃ´ng", "CÃ³"])
    austim = st.selectbox("13. Gia Ä‘Ã¬nh báº¡n cÃ³ ngÆ°á»i tá»«ng bá»‹ tá»± ká»· khÃ´ng?", ["KhÃ´ng", "CÃ³"])
    relation = st.selectbox("14. Báº¡n lÃ  ai Ä‘á»‘i vá»›i ngÆ°á»i Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡?", ["Bá»‘/máº¹", "Báº£n thÃ¢n", "NgÆ°á»i thÃ¢n khÃ¡c", "KhÃ¡c"])
    age_desc = st.selectbox("15. NhÃ³m tuá»•i cá»§a ngÆ°á»i Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡?", ["DÆ°á»›i 18 tuá»•i", "Tá»« 18 tuá»•i trá»Ÿ lÃªn"])

    # MÃ£ hÃ³a
    used_app_before = 1 if used_app_before == "Rá»“i" else 0
    jundice = 1 if jundice == "CÃ³" else 0
    austim = 1 if austim == "CÃ³" else 0
    relation_map = {"Bá»‘/máº¹": 0, "Báº£n thÃ¢n": 1, "NgÆ°á»i thÃ¢n khÃ¡c": 2, "KhÃ¡c": 3}
    relation = relation_map[relation]
    age_desc = 0 if age_desc == "DÆ°á»›i 18 tuá»•i" else 1

    features = scores + [used_app_before, jundice, relation, austim, age_desc]
    return np.array([features])

# Dá»± Ä‘oÃ¡n
def du_doan(features):
    scaled = scaler.transform(features)
    return model.predict(scaled)[0]

# Cháº¡y á»©ng dá»¥ng
input_data = nhap_du_lieu()
if st.button("ğŸ“Š Dá»± Ä‘oÃ¡n kháº£ nÄƒng tá»± ká»·"):
    pred = du_doan(input_data)
    st.markdown("### ğŸ§­ Gá»£i Ã½ hÃ nh Ä‘á»™ng tiáº¿p theo:")
    if pred == 1:
        st.info("""
        ğŸ”¹ NgÆ°á»i nÃ y cÃ³ kháº£ nÄƒng cao máº¯c chá»©ng rá»‘i loáº¡n phá»• tá»± ká»·.
        HÃ£y liÃªn há»‡ chuyÃªn gia tÃ¢m lÃ½ hoáº·c cÆ¡ sá»Ÿ y táº¿ Ä‘á»ƒ Ä‘Æ°á»£c tÆ° váº¥n ká»¹ lÆ°á»¡ng hÆ¡n.
        ğŸ”¹ Ghi chÃ©p láº¡i cÃ¡c biá»ƒu hiá»‡n thÆ°á»ng gáº·p trong cuá»™c sá»‘ng hÃ ng ngÃ y.
        ğŸ”¹ CÃ³ thá»ƒ tham kháº£o cÃ¡c tÃ i liá»‡u vá» ASD tá»« WHO, CDC hoáº·c cÃ¡c trung tÃ¢m há»— trá»£ trong nÆ°á»›c.
        """)
    else:
        st.success("""
        âœ… Báº¡n cÃ³ thá»ƒ yÃªn tÃ¢m á»Ÿ thá»i Ä‘iá»ƒm hiá»‡n táº¡i.
        ğŸ”¹ Viá»‡c phÃ¡t triá»ƒn ká»¹ nÄƒng xÃ£ há»™i vÃ  cáº£m xÃºc váº«n á»•n.
        ğŸ”¹ Náº¿u cÃ²n bÄƒn khoÄƒn, báº¡n cÃ³ thá»ƒ trao Ä‘á»•i thÃªm vá»›i chuyÃªn gia.
        """)

